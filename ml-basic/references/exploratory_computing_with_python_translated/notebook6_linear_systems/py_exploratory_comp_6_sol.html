
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Exploratory Computing with Python &#8212; ml-basic</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ml-basic/references/exploratory_computing_with_python_translated/notebook6_linear_systems/py_exploratory_comp_6_sol';</script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../_static/logo.png" class="logo__image only-light" alt="ml-basic - Home"/>
    <img src="../../../../_static/logo.png" class="logo__image only-dark pst-js-only" alt="ml-basic - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../README.html">
                    Machine Learning Algorithms Guide
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../books/Chapter1.html">机器学习概要</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../books/Chapter2.html">2.有监督学习</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../books/Chapter3.html">3.无监督学习</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../books/Chapter4.html">第四章 评估方法和各种数据的处理</a></li>



<li class="toctree-l1"><a class="reference internal" href="../../books/Iris.html">实践应用：</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../books/jupyter_use.html">jupyter 入门</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../books/LSA.html">例子：简单文档集合的 LSA 处理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../books/PCA.html">步骤 1: 数据标准化</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../books/VisibleTools.html">Matplotlib</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fml-basic/references/exploratory_computing_with_python_translated/notebook6_linear_systems/py_exploratory_comp_6_sol.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../_sources/ml-basic/references/exploratory_computing_with_python_translated/notebook6_linear_systems/py_exploratory_comp_6_sol.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Exploratory Computing with Python</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notebook-6-systems-of-linear-equations">Notebook 6: Systems of linear equations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-and-solving-a-system-of-linear-equations">Building and solving a system of linear equations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-fitting-a-wave">Exercise 1. <a name="back1"></a>Fitting a wave</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-an-arbitrary-polynomial">Fitting an arbitrary polynomial</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-the-fpoly-function">Exercise 2. <a name="back2"></a>The <code class="docutils literal notranslate"><span class="pre">fpoly</span></code> function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-the-solvepoly-function">Exercise 3. <a name="back3"></a>The <code class="docutils literal notranslate"><span class="pre">solvepoly</span></code> function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-the-fpolyeval-function">Exercise 4.  <a name="back3"></a>The <code class="docutils literal notranslate"><span class="pre">fpolyeval</span></code> function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-dimensional-groundwater-flow">One-dimensional groundwater flow</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5-the-head-between-two-canals">Exercise 5. <a name="back5"></a>The head between two canals</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#consolidation">Consolidation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6-one-dimensional-consolidation">Exercise 6. <a name="back6"></a>One-dimensional consolidation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-inverse-of-a-matrix">The inverse of a matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7-one-dimensional-consolidation-revisited">Exercise 7. <a name="back7"></a>One-dimensional consolidation revisited</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sparse-matrices">Sparse matrices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8-sparse-matrix">Exercise 8 <a name="back8"></a> Sparse matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solutions-to-the-exercises">Solutions to the exercises</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <figure>
  <IMG SRC="https://raw.githubusercontent.com/mbakker7/exploratory_computing_with_python/master/tudelft_logo.png" WIDTH=250 ALIGN="right">
</figure>
<section class="tex2jax_ignore mathjax_ignore" id="exploratory-computing-with-python">
<h1>Exploratory Computing with Python<a class="headerlink" href="#exploratory-computing-with-python" title="Link to this heading">#</a></h1>
<p><em>Developed by Mark Bakker</em></p>
<section id="notebook-6-systems-of-linear-equations">
<h2>Notebook 6: Systems of linear equations<a class="headerlink" href="#notebook-6-systems-of-linear-equations" title="Link to this heading">#</a></h2>
<p>In this Notebook, we learn how to build and solve systems of linear equations, and apply these techniques to solve practical problems.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_line_magic</span><span class="p">(</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;inline&#39;</span><span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;numpy&#39;
</pre></div>
</div>
</div>
</div>
<section id="building-and-solving-a-system-of-linear-equations">
<h3>Building and solving a system of linear equations<a class="headerlink" href="#building-and-solving-a-system-of-linear-equations" title="Link to this heading">#</a></h3>
<p>A parabola is defined by three points (provided they are not on a straight line).
The equation for a parabola is <span class="math notranslate nohighlight">\(y=ax^2+bx+c\)</span>, where <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, and <span class="math notranslate nohighlight">\(c\)</span> are constants.
Given three points <span class="math notranslate nohighlight">\((x_1,y_1)\)</span>, <span class="math notranslate nohighlight">\((x_2,y_2)\)</span>, <span class="math notranslate nohighlight">\((x_3,y_3)\)</span>, the following system of three linear equations may be compiled</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{split}
x_1^2a+x_1b+c&amp;=y_1 \\
x_2^2a+x_2b+c&amp;=y_2 \\
x_3^2a+x_3b+c&amp;=y_3 \\
\end{split}
\end{split}\]</div>
<p>Or in matrix form</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left(
\begin{array}{ccc}
x_1^2 &amp; x_1 &amp; 1 \\
x_2^2 &amp; x_2 &amp; 1 \\
x_3^2 &amp; x_3 &amp; 1 \\
\end{array}
\right)
\left(
\begin{array}{c}
a \\b \\c \\
\end{array}
\right)
=
\left(
\begin{array}{c}
y_1 \\
y_2 \\
y_3 \\
\end{array}
\right)
\end{split}\]</div>
<p>To solve this problem, we build a two-dimensional array containing the matrix (called <code class="docutils literal notranslate"><span class="pre">A</span></code>) and a one-dimensional array containing the right-hand side (called <code class="docutils literal notranslate"><span class="pre">rhs</span></code>).
Let’s do that for the three points <span class="math notranslate nohighlight">\((x_1,y_1)=(-2,2)\)</span>, <span class="math notranslate nohighlight">\((x_2,y_2)=(1,-1)\)</span>, <span class="math notranslate nohighlight">\((x_3,y_3)=(4,4)\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">yp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">rhs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">xp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span>  <span class="c1"># Store one row at a time</span>
    <span class="n">rhs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">yp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Array A:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rhs:&#39;</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Array A:
[[  4.  -2.   1.]
 [  1.   1.   1.]
 [ 16.   4.   1.]]
rhs: [ 2. -1.  4.]
</pre></div>
</div>
</div>
</div>
<p>The system may be solved with the <code class="docutils literal notranslate"><span class="pre">solve</span></code> method, which is part of the <code class="docutils literal notranslate"><span class="pre">linalg</span></code> subpackage of <code class="docutils literal notranslate"><span class="pre">numpy</span></code>. The <code class="docutils literal notranslate"><span class="pre">solve</span></code> method takes as input a two-dimensional array (the matrix) and a one-dimensional array (the right-hand side) and returns the solution. To check whether the solution is correct, we need to do a matrix multiply of the matrix stored in the array <code class="docutils literal notranslate"><span class="pre">A</span></code> and the obtained solution, which we call <code class="docutils literal notranslate"><span class="pre">sol</span></code>. As we learned the line</p>
<p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">*</span> <span class="pre">sol</span></code></p>
<p>does a term-by-term multiply. For a matrix multiply, the <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> symbol needs to be used (alternatively, the <code class="docutils literal notranslate"><span class="pre">np.dot</span></code> function can be used; the <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> symbol does not work in Python 2).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;solution is:&#39;</span><span class="p">,</span> <span class="n">sol</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;specified values of y:&#39;</span><span class="p">,</span> <span class="n">yp</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A @ sol:&#39;</span><span class="p">,</span> <span class="n">A</span> <span class="o">@</span> <span class="n">sol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>solution is: [ 0.44444444 -0.55555556 -0.88888889]
specified values of y: [ 2 -1  4]
A @ sol: [ 2. -1.  4.]
</pre></div>
</div>
</div>
</div>
<p>We can also visually check whether we solved the problem correctly by drawing the three points and the parabola.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">yp</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">sol</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">sol</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/bb6b17c5ae4fafc7d63d8ac51c6e2b60c9c613fbf94be351a054a40ec049c1ac.png" src="../../../../_images/bb6b17c5ae4fafc7d63d8ac51c6e2b60c9c613fbf94be351a054a40ec049c1ac.png" />
</div>
</div>
</section>
<section id="exercise-1-fitting-a-wave">
<h3>Exercise 1. <a name="back1"></a>Fitting a wave<a class="headerlink" href="#exercise-1-fitting-a-wave" title="Link to this heading">#</a></h3>
<p>Consider the following four measurements of the quantity <span class="math notranslate nohighlight">\(y\)</span> at time <span class="math notranslate nohighlight">\(t\)</span>: <span class="math notranslate nohighlight">\((t_0,y_0)=(0,3)\)</span>, <span class="math notranslate nohighlight">\((t_1,y_1)=(0.25,1)\)</span>, <span class="math notranslate nohighlight">\((t_2,y_2)=(0.5,-3)\)</span>, <span class="math notranslate nohighlight">\((t_3,y_3)=(0.75,1)\)</span>. The measurements are part of a wave that may be written as</p>
<p><span class="math notranslate nohighlight">\(y = a\cos(\pi t) + b\cos(2\pi t) + c\cos(3\pi t) + d\cos(4\pi t)\)</span></p>
<p>where <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(c\)</span>, and <span class="math notranslate nohighlight">\(d\)</span> are parameters. Build a system of four linear equations and solve for the four parameters. Creates a plot of the wave for <span class="math notranslate nohighlight">\(t\)</span> going from 0 to 1 and show the four measurements with dots.</p>
<p><a href="#ex1answer">Answers to Exercise 1</a></p>
</section>
<section id="fitting-an-arbitrary-polynomial">
<h3>Fitting an arbitrary polynomial<a class="headerlink" href="#fitting-an-arbitrary-polynomial" title="Link to this heading">#</a></h3>
<p>In the next three exerises, we are going to fit a polynomial of arbitary degree <span class="math notranslate nohighlight">\(N\)</span> to a set of <span class="math notranslate nohighlight">\(N+1\)</span> data points. The function we are going to fit is</p>
<div class="math notranslate nohighlight">
\[f(x) = a_0 + a_1x + a_2x^2 + ... + a_Nx^N = \sum\limits_{n=0}^{N}a_nx^n\]</div>
<p>Note that there are <span class="math notranslate nohighlight">\(N+1\)</span> parameters <span class="math notranslate nohighlight">\(a_n\)</span>, while the degree of the polynomial is called <span class="math notranslate nohighlight">\(N\)</span>.</p>
</section>
<section id="exercise-2-the-fpoly-function">
<h3>Exercise 2. <a name="back2"></a>The <code class="docutils literal notranslate"><span class="pre">fpoly</span></code> function<a class="headerlink" href="#exercise-2-the-fpoly-function" title="Link to this heading">#</a></h3>
<p>First, write a function called <code class="docutils literal notranslate"><span class="pre">fpoly</span></code> that returns an array where item <span class="math notranslate nohighlight">\(n\)</span> is equal to <span class="math notranslate nohighlight">\(x^n\)</span>. The input arguments of the function are the value of <span class="math notranslate nohighlight">\(x\)</span> and the degree of the polynomial <span class="math notranslate nohighlight">\(N\)</span>. The output of the function is an array of length <span class="math notranslate nohighlight">\(N+1\)</span>. Test your function for <span class="math notranslate nohighlight">\(x=2\)</span> and <span class="math notranslate nohighlight">\(N=4\)</span> by executing</p>
<p><code class="docutils literal notranslate"><span class="pre">print</span> <span class="pre">fpoly(2,</span> <span class="pre">4)</span></code></p>
<p>which should return <code class="docutils literal notranslate"><span class="pre">[</span>&#160; <span class="pre">1.</span>&#160;&#160; <span class="pre">2.</span>&#160;&#160; <span class="pre">4.</span>&#160;&#160; <span class="pre">8.</span>&#160; <span class="pre">16.]</span></code>.</p>
<p><a href="#ex2answer">Answers to Exercise 2</a></p>
</section>
<section id="exercise-3-the-solvepoly-function">
<h3>Exercise 3. <a name="back3"></a>The <code class="docutils literal notranslate"><span class="pre">solvepoly</span></code> function<a class="headerlink" href="#exercise-3-the-solvepoly-function" title="Link to this heading">#</a></h3>
<p>Next, write a function that computes the parameters <span class="math notranslate nohighlight">\(a_n\)</span> to fit a polynomial of degree <span class="math notranslate nohighlight">\(N\)</span> through <span class="math notranslate nohighlight">\(N+1\)</span> data points. Call the function <code class="docutils literal notranslate"><span class="pre">solvepoly</span></code>. The input arguments of the function are an array <span class="math notranslate nohighlight">\(x\)</span> of length <span class="math notranslate nohighlight">\(N+1\)</span> and an array <span class="math notranslate nohighlight">\(y\)</span> of length <span class="math notranslate nohighlight">\(N+1\)</span>. The output is an array of parameters <span class="math notranslate nohighlight">\(a_n\)</span> such that a polynomial of degree <span class="math notranslate nohighlight">\(N\)</span> goes exactly through the <span class="math notranslate nohighlight">\(N+1\)</span> data points <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>. Inside the function, you need to compute a matrix of <span class="math notranslate nohighlight">\(N+1\)</span> equations for the <span class="math notranslate nohighlight">\(N+1\)</span> unknown parameters. For each of the rows of the matrix, call the function <code class="docutils literal notranslate"><span class="pre">fpoly</span></code>. Test your function by executing the following four commands. If your code is correct, the parameter array <code class="docutils literal notranslate"><span class="pre">a</span></code> is [ 3.          2.33333333 -6.          1.66666667].</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>xp = np.array([0, 1, 2, 3])
yp = np.array([3, 1, -3, 1])
a = solvepoly(xp, yp)
print(a)
</pre></div>
</div>
<p><a href="#ex3answer">Answers to Exercise 3</a></p>
</section>
<section id="exercise-4-the-fpolyeval-function">
<h3>Exercise 4.  <a name="back3"></a>The <code class="docutils literal notranslate"><span class="pre">fpolyeval</span></code> function<a class="headerlink" href="#exercise-4-the-fpolyeval-function" title="Link to this heading">#</a></h3>
<p>Finally, write a function called <code class="docutils literal notranslate"><span class="pre">fpolyeval</span></code> to evaluate the function <span class="math notranslate nohighlight">\(f(x) = \sum\limits_{n=0}^{N}a_nx^n\)</span> for given parameters <span class="math notranslate nohighlight">\(a\)</span> and an array of <span class="math notranslate nohighlight">\(x\)</span> values. The <code class="docutils literal notranslate"><span class="pre">fpolyeval</span></code> function takes as input argument an array of arbitrary length <span class="math notranslate nohighlight">\(x\)</span> and an array of parameters <span class="math notranslate nohighlight">\(a\)</span> of length <span class="math notranslate nohighlight">\(N+1\)</span>. The function returns an array of <span class="math notranslate nohighlight">\(f(x)\)</span> values with a length equal to the length of <span class="math notranslate nohighlight">\(x\)</span>. First test your function by executing</p>
<p><code class="docutils literal notranslate"><span class="pre">fpolyeval(xp,</span> <span class="pre">a)</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">xp</span></code> is the array with the values entered in Exercise 3 and <code class="docutils literal notranslate"><span class="pre">a</span></code> are the parameters computed in Exercise 3. When you programmed everything correctly, the function should return the four values of <code class="docutils literal notranslate"><span class="pre">yp</span></code> specified in Exercise 3. Test your function further by running the following commands, which should plot the four data points of Exercise 3 as markers and the 3<span class="math notranslate nohighlight">\(^\text{rd}\)</span> degree polynomial that goes exactly through the four points.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>x = np.linspace(-1,4,100)
y = fpolyeval(x, a)
plt.plot(xp, yp, &#39;ko&#39;, label=&#39;data&#39;)
plt.plot(x, y, label=&#39;fitted poly&#39;)
plt.legend(loc=&#39;best&#39;);
</pre></div>
</div>
<p><a href="#ex4answer">Answers to Exercise 4</a></p>
</section>
<section id="one-dimensional-groundwater-flow">
<h3>One-dimensional groundwater flow<a class="headerlink" href="#one-dimensional-groundwater-flow" title="Link to this heading">#</a></h3>
<p>Consider a sand layer covered by a clay layer. The sand layer is bounded on each side by a canal with fixed water level <span class="math notranslate nohighlight">\(h_1^*\)</span> (left) and <span class="math notranslate nohighlight">\(h_2^*\)</span> (right); the distance between the two canals is <span class="math notranslate nohighlight">\(L\)</span>. Water leaks through the clay layer at a constant rate <span class="math notranslate nohighlight">\(P\)</span> (see Figure). The groundwater head in the sand layer is governed by the second-order ordinary differential equation</p>
<div class="math notranslate nohighlight">
\[\frac{\text{d}^2h}{\text{d}x^2} = -\frac{P}{kD}\]</div>
<p>where <span class="math notranslate nohighlight">\(h\)</span> is the head, <span class="math notranslate nohighlight">\(k\)</span> is the hydraulic conductivity of the sand layer, and <span class="math notranslate nohighlight">\(D\)</span> is the thickness of the sand layer. The boundary conditions are that <span class="math notranslate nohighlight">\(h=h_1^*\)</span> at <span class="math notranslate nohighlight">\(x=0\)</span> and <span class="math notranslate nohighlight">\(h=h_2^*\)</span> at <span class="math notranslate nohighlight">\(x=L\)</span>.</p>
<img src="http://i.imgur.com/2DH0sxT.png" alt="Consolidation" width=400pt>
<p>Although it is easy to solve this problem exactly, we will solve it here numerically using the finite difference method (which allows for <span class="math notranslate nohighlight">\(P\)</span> to be a function of <span class="math notranslate nohighlight">\(x\)</span>, for example). The head is computed at <span class="math notranslate nohighlight">\(N+1\)</span> equally spaced points from <span class="math notranslate nohighlight">\(x=0\)</span> to <span class="math notranslate nohighlight">\(x=L\)</span>. The points are labeled <span class="math notranslate nohighlight">\(x_0\)</span> through <span class="math notranslate nohighlight">\(x_{N}\)</span>, where <span class="math notranslate nohighlight">\(x_n=n\Delta x\)</span>, and <span class="math notranslate nohighlight">\(\Delta x\)</span> is the horizontal distance between the points. The head at point <span class="math notranslate nohighlight">\(x_n\)</span> is called <span class="math notranslate nohighlight">\(h_n\)</span>. The second order derivative can be approximated as (see, e.g., Verrujt (2012) Soil Mechanics, Eq. 17.4; a link to a pdf of the full text of this book may be found under Software <a class="reference external" href="http://geo.verruijt.net/">here</a>.</p>
<div class="math notranslate nohighlight">
\[\frac{\text{d}^2h}{\text{d}x^2} \approx \frac{1}{\Delta x} \left[ \frac{h_{n+1}-h_n}{\Delta x} - \frac{h_{n}-h_{n-1}}{\Delta x} \right]= \frac{h_{n-1}-2h_n+h_{n+1}}{(\Delta x)^2}\]</div>
<p>Substitution of this approximation of the derivative in the differential equation and rearranging terms gives</p>
<div class="math notranslate nohighlight">
\[h_{n-1}-2h_n+h_{n+1} = -P\frac{(\Delta x)^2}{kD}\]</div>
<p>An equation like this may be written for every point <span class="math notranslate nohighlight">\(n\)</span>, except for the first and last point where we need to apply the boundary conditions:</p>
<div class="math notranslate nohighlight">
\[h_0=h_1^* \qquad h_N=h_2^*\]</div>
<p>When <span class="math notranslate nohighlight">\(N=4\)</span>, we need to solve a system of <span class="math notranslate nohighlight">\(N+1=5\)</span> linear equations in the unknowns <span class="math notranslate nohighlight">\(h_0\)</span> through <span class="math notranslate nohighlight">\(h_4\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
h_0 &amp;= h_1^*  \\
h_{0}-2h_1+h_{2} &amp;= -P(\Delta x)^2/(kD) \\
h_{1}-2h_2+h_{3} &amp;= -P(\Delta x)^2/(kD) \\
h_{2}-2h_3+h_{4} &amp;= -P(\Delta x)^2/(kD) \\
h_4 &amp;= h_2^* 
\end{split}\end{split}\]</div>
<p>or in matrix form</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left(
\begin{array}{ccccc}
1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
1 &amp; -2 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; -2 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; -2 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right)
\left(
\begin{array}{c}
h_0 \\
h_1 \\
h_2 \\
h_3 \\
h_4 \\
\end{array}
\right)
=
\left(
\begin{array}{c}
h_1^* \\
-P(\Delta x)^2/(kD) \\
-P(\Delta x)^2/(kD) \\
-P(\Delta x)^2/(kD) \\
h_2^* \\
\end{array}
\right)
\end{split}\]</div>
<p>Note that the matrix consists of mostly zeros. The matrix is referred to as a tri-diagonal matrix, as there are only values along three diagonals of the matrix. The matrix may be constructed by specifying the values and positions of the diagonals. The main diagonal has position number zero and has length <span class="math notranslate nohighlight">\(N+1\)</span>. The diagonal right above the main diagonal has position number <span class="math notranslate nohighlight">\(+1\)</span> and length <span class="math notranslate nohighlight">\(N\)</span>, while the diagonal below the main diagonal has position number <span class="math notranslate nohighlight">\(-1\)</span> and also length <span class="math notranslate nohighlight">\(N\)</span>. The <code class="docutils literal notranslate"><span class="pre">np.diag</span></code> function creates a matrix consisting of one diagonal. The input arguments are an array of the correct length with the values along the diagonal and the position of the diagonal. The matrix may be constructed as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">d0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># main diagonal</span>
<span class="n">d0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># first value of main diagonal is 1</span>
<span class="n">d0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># last value of main diagonal is 1</span>
<span class="n">dplus1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="c1"># diagonal right above main diagonal, position 1</span>
<span class="n">dplus1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c1"># first value of diagonal is 0</span>
<span class="n">dmin1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>  <span class="c1"># diagonal right below main diagonal, position -1</span>
<span class="n">dmin1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c1"># last value of diagonal is 0</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">d0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">dplus1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">dmin1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.  0.  0.  0.  0.]
 [ 1. -2.  1.  0.  0.]
 [ 0.  1. -2.  1.  0.]
 [ 0.  0.  1. -2.  1.]
 [ 0.  0.  0.  0.  1.]]
</pre></div>
</div>
</div>
</div>
<p>Note that the finite-difference method described above is accurate when you use a reasonable number of points. Four points won’t cut it. You may figure out whether you used enough points by, for example, doubling the number of points and compare the two solutions.</p>
</section>
<section id="exercise-5-the-head-between-two-canals">
<h3>Exercise 5. <a name="back5"></a>The head between two canals<a class="headerlink" href="#exercise-5-the-head-between-two-canals" title="Link to this heading">#</a></h3>
<p>Compute the head distribution in a sand layer bounded on each side by a canal. Given: <span class="math notranslate nohighlight">\(k=10\)</span> m/day, <span class="math notranslate nohighlight">\(D=10\)</span> m, <span class="math notranslate nohighlight">\(h_1^*=20\)</span> m, <span class="math notranslate nohighlight">\(h_2^*=22\)</span> m, <span class="math notranslate nohighlight">\(L=1000\)</span> m, <span class="math notranslate nohighlight">\(P=0.001\)</span> m/d. Use <span class="math notranslate nohighlight">\(N=40\)</span>. Write Python code to:</p>
<ul class="simple">
<li><p>Solve for the heads in all <span class="math notranslate nohighlight">\(N+1\)</span> points</p></li>
<li><p>Print the maximum value of the head between the two canals to the screen (this should be around 22.5)</p></li>
<li><p>Create a plot of the head vs. <span class="math notranslate nohighlight">\(x\)</span>. Label the axes.</p></li>
</ul>
<p><a href="#ex5answer">Answers to Exercise 5</a></p>
</section>
<section id="consolidation">
<h3>Consolidation<a class="headerlink" href="#consolidation" title="Link to this heading">#</a></h3>
<p>The deformation of saturated clay soils is a slow process, referred to as consolidation. In the compression of a soil, the porosity decreases, and as a result there is less space available for pore water. Hence, some pore water needs to be pushed out of the soil during compression. This may take considerable time in clays, as the permeability of clays is small. An extensive description of the consolidation process may be found in, e.g., Chapters 15-17 of Verruijt, 2012, Soil Mechanics, see this <a class="reference external" href="http://geo.verruijt.net/">link</a>.</p>
<p>Consider one-dimensional consolidation in a soil of height <span class="math notranslate nohighlight">\(h\)</span>. The water pressure <span class="math notranslate nohighlight">\(p\)</span> in the soil sample is governed by the differential equation</p>
<div class="math notranslate nohighlight">
\[\frac{\partial p}{\partial t} = c_v \frac{\partial^2 p}{\partial z^2}\]</div>
<p>where <span class="math notranslate nohighlight">\(z\)</span> is the vertical coordinate (positive upward), and <span class="math notranslate nohighlight">\(c_v\)</span> is the consolidation coefficient.  We consider the problem where water can drain out at the top, but not at the bottom, so that the boundary condition at the bottom is</p>
<div class="math notranslate nohighlight">
\[z=0 \qquad \frac{\partial p}{\partial z} = 0\]</div>
<p>and the boundary condition at the top is</p>
<div class="math notranslate nohighlight">
\[z=h \qquad p = 0\]</div>
<p>A constant load is applied at the top at time <span class="math notranslate nohighlight">\(t=0\)</span> resulting, initially, in a uniform pressure <span class="math notranslate nohighlight">\(q\)</span> throughout the soil sample (except for at <span class="math notranslate nohighlight">\(z=0\)</span>, where the pressure is always zero).</p>
<div class="math notranslate nohighlight">
\[t=0 \qquad p = q\]</div>
<img src="http://i.imgur.com/4xdeoxw.png" alt="Consolidation" width=400pt><p>The change of pressure with time in the soil is simulated with a numerical method (fully implicit finite differences, to be exact). The pressure is computed at <span class="math notranslate nohighlight">\(N+1\)</span> points, equally distributed from <span class="math notranslate nohighlight">\(z=0\)</span> to <span class="math notranslate nohighlight">\(z=h\)</span>. The points are labeled <span class="math notranslate nohighlight">\(z_0\)</span> through <span class="math notranslate nohighlight">\(z_{N}\)</span>, where <span class="math notranslate nohighlight">\(z_n=n\Delta z\)</span> and <span class="math notranslate nohighlight">\(\Delta z\)</span> is the vertical distance between the points. The pressure at point <span class="math notranslate nohighlight">\(z_n\)</span> is called <span class="math notranslate nohighlight">\(p_n\)</span>. A separate solution is computed for every time step <span class="math notranslate nohighlight">\(\Delta t\)</span>. The time derivative is approximated as</p>
<div class="math notranslate nohighlight">
\[\frac{\partial p}{\partial t} \approx \frac{p_n(t) - p_n(t-\Delta t)}{\Delta t}\]</div>
<p>while the spatial derivative is approximated as</p>
<div class="math notranslate nohighlight">
\[\frac{\partial^2 p}{\partial z^2} \approx \frac{p_{n-1}(t) -2p_n(t) + p_{n+1}(t)}{\Delta z)^2} \]</div>
<p>Subsitution of the approximations of these derivatives and gathering terms gives the following equation:</p>
<div class="math notranslate nohighlight">
\[p_{n-1}(t) - (2+\mu)p_n(t) + p_{n+1}(t) = -\mu p_n(t-\Delta t)\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\mu = (\Delta z)^2/(c_v\Delta t)\]</div>
<p>This is an equation for the pressure in points <span class="math notranslate nohighlight">\((n-1)\)</span>, <span class="math notranslate nohighlight">\(n\)</span>, and <span class="math notranslate nohighlight">\((n+1)\)</span> at time <span class="math notranslate nohighlight">\(t\)</span>, where it is assumed that the pressure at time <span class="math notranslate nohighlight">\(t-\Delta t\)</span> is known.</p>
<p>The equations for <span class="math notranslate nohighlight">\(n=0\)</span> and <span class="math notranslate nohighlight">\(n=N\)</span> are different.
At the bottom of the sample (<span class="math notranslate nohighlight">\(n=0\)</span>) the boundary condition is <span class="math notranslate nohighlight">\(\partial p/\partial z = 0\)</span>. The derivative may be approximated at <span class="math notranslate nohighlight">\(z_0=0\)</span> as</p>
<div class="math notranslate nohighlight">
\[\left(\frac{\partial p}{\partial z}\right)_{z=0} \approx (p_1-p_{-1})/(2\Delta z)=0\]</div>
<p>where <span class="math notranslate nohighlight">\(p_{-1}\)</span> is the pressure at an imaginary point <span class="math notranslate nohighlight">\(\Delta z\)</span> below <span class="math notranslate nohighlight">\(z_0\)</span>. The derivative is zero when <span class="math notranslate nohighlight">\(p_{-1}=p_1\)</span>, and substitution in the equation for <span class="math notranslate nohighlight">\(n=0\)</span> gives</p>
<div class="math notranslate nohighlight">
\[- (2+\mu)p_n(t) + 2p_{n+1}(t) = -\mu p_n(t-\Delta t)\]</div>
<p>The equation for <span class="math notranslate nohighlight">\(n=N\)</span> is easier, as at the top of the sample (<span class="math notranslate nohighlight">\(n=N\)</span>) the pressure is fixed to <span class="math notranslate nohighlight">\(p_N=0\)</span>.</p>
<p>As an example, the system of equations for <span class="math notranslate nohighlight">\(N=4\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left(
\begin{array}{ccccc}
-(2+\mu) &amp; 2 &amp; 0 &amp; 0 &amp; 0 \\
1 &amp; -(2+\mu) &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; -(2+\mu) &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; -(2+\mu) &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right)
\left(
\begin{array}{c}
p_0(t) \\
p_1(t) \\
p_2(t) \\
p_3(t) \\
p_4(t) \\
\end{array}
\right)
=
\left(
\begin{array}{c}
-\mu p_0(t-\Delta t)) \\
-\mu p_1(t-\Delta t)) \\
-\mu p_2(t-\Delta t)) \\
-\mu p_3(t-\Delta t) \\
0 \\
\end{array}
\right)
\end{split}\]</div>
<p>A solution is obtained by stepping through time. The matrix needs to be computed only once, as it doesn’t change through time. Every time step, a new right-hand-side needs to be computed and a linear system of <span class="math notranslate nohighlight">\(N+1\)</span> equations needs to be solved. If the matrix is called <span class="math notranslate nohighlight">\(A\)</span> and the right-hand-side (based on the pressures at <span class="math notranslate nohighlight">\(t-\Delta t\)</span>) is called <span class="math notranslate nohighlight">\(\vec{r}(t-\Delta t)\)</span>, then the pressure at time <span class="math notranslate nohighlight">\(t\)</span>, <span class="math notranslate nohighlight">\(\vec{p}(t)\)</span>, is obtained by solving the system</p>
<div class="math notranslate nohighlight">
\[A\vec{p}(t) = \vec{r}(t-\Delta t)\]</div>
<p>Note again that the presented numerical solution procedure is approximate and only gives accurate solutions when the time step <span class="math notranslate nohighlight">\(\Delta t\)</span> and the spatial discretization <span class="math notranslate nohighlight">\(\Delta z\)</span> are chosen small enough.</p>
</section>
<section id="exercise-6-one-dimensional-consolidation">
<h3>Exercise 6. <a name="back6"></a>One-dimensional consolidation<a class="headerlink" href="#exercise-6-one-dimensional-consolidation" title="Link to this heading">#</a></h3>
<p>Consider the consolidation process of a clay layer that is 2 m thick. A uniform load is applied at time <span class="math notranslate nohighlight">\(t=0\)</span> causing a unit increase in the pressure, i.e., <span class="math notranslate nohighlight">\(p(t=0)=1\)</span>. The consolidation coefficient of the clay is <span class="math notranslate nohighlight">\(c_v=1\cdot 10^{-6}\)</span> m<span class="math notranslate nohighlight">\(^2\)</span>/s. Simulate the consolidation process using the numerical method described above. Use <span class="math notranslate nohighlight">\(N=40\)</span> and a time step <span class="math notranslate nohighlight">\(\Delta t=4\cdot 10^4\)</span> sec. Take 50 time steps and plot the pressure distribution in the clay every 10 time steps. Add labels along the axes and a legend. Compare your solution to the graph in Fig. 16.2 of Veruit (2012) (Note that Verruijt plots <span class="math notranslate nohighlight">\(p\)</span> along the horizontal axis). The last line of your plot should approximate the line <span class="math notranslate nohighlight">\(c_v t / h^2=0.5\)</span> in the graph of Verrujt.</p>
<p>Make sure that your Python code:</p>
<ul class="simple">
<li><p>Solves for the pressure in all <span class="math notranslate nohighlight">\(N+1\)</span> points for all 50 time steps and plots the results after 10, 20, 30, 40, and 50 time steps.</p></li>
<li><p>Prints the maximum value of the pressure to the screen after 10, 20, 30, 40, and 50 time steps.</p></li>
</ul>
<p><a href="#ex6answer">Answers to Exercise 6</a></p>
</section>
<section id="the-inverse-of-a-matrix">
<h3>The inverse of a matrix<a class="headerlink" href="#the-inverse-of-a-matrix" title="Link to this heading">#</a></h3>
<p>As mentioned, the values of the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> don’t change through time. Hence, it is more efficient to compute and store the inverse of the matrix rather than repeatedly calling the <code class="docutils literal notranslate"><span class="pre">np.linalg.solve</span></code> method. The inverse of a matrix may be computed with the <code class="docutils literal notranslate"><span class="pre">inv</span></code> function of the <code class="docutils literal notranslate"><span class="pre">linalg</span></code> package. If the inverse of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> is called <code class="docutils literal notranslate"><span class="pre">Ainv</span></code>, the solution for the pressure may be obtained through matrix multiplication of <code class="docutils literal notranslate"><span class="pre">Ainv</span></code> with the right-hand side. For example, for the first problem in this Notebook, fitting a parabola through three points, the inverse of the matrix can be computed to obtain a solution as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">16</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">rhs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">Ainv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">Ainv</span> <span class="o">@</span> <span class="n">rhs</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;sol:&#39;</span><span class="p">,</span> <span class="n">sol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sol: [ 0.44444444 -0.55555556 -0.88888889]
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-7-one-dimensional-consolidation-revisited">
<h3>Exercise 7. <a name="back7"></a>One-dimensional consolidation revisited<a class="headerlink" href="#exercise-7-one-dimensional-consolidation-revisited" title="Link to this heading">#</a></h3>
<p>Modify your solution to Exercise 6 by computing and storing the inverse of the matrix, and compute a solution through multiplication of the inverse of the matrix with the right-hand-side vector</p>
<p><a href="#ex7answer">Answers to Exercise 7</a></p>
</section>
<section id="sparse-matrices">
<h3>Sparse matrices<a class="headerlink" href="#sparse-matrices" title="Link to this heading">#</a></h3>
<p>The prodedure we have used so far to construct the matrix for a finite-difference solution is not very efficient, as a full matrix is created, which consists of mainly zeros. Non-zero values only appear on three diagonals. There are more efficient routines that store what are called <em>sparse matrices</em>. In a sparse matrix, only the value and location of non-zero values in a matrix are stored. Functionality for sparse matrices is available in the <code class="docutils literal notranslate"><span class="pre">scipy.sparse</span></code> package. A sparse matrix may be created from diagonals with the <code class="docutils literal notranslate"><span class="pre">diags</span></code> function, which takes a list of arrays for the diagonals and a list of the numbers of the diagonals. For example, the matrix
$<span class="math notranslate nohighlight">\(\left(
\begin{array}{cccc}
2 &amp; 3 &amp; 0 &amp; 0 \\
1 &amp; 2 &amp; 3 &amp; 0 \\
0 &amp; 1 &amp; 2 &amp; 3 \\
0 &amp; 0 &amp; 1 &amp; 2 \\
\end{array}
\right)\)</span>$
is created as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.sparse</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">diags</span><span class="p">([</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> 
              <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> 
              <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span> 
             <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;csc&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sparse matrix A&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="c1"># Gives the way A is stored: row, column, value</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Full matrix A as an array&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>  <span class="c1"># Returns the equivalent full array</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sparse matrix A
  (1, 0)	1.0
  (0, 0)	2.0
  (2, 1)	1.0
  (1, 1)	2.0
  (0, 1)	3.0
  (3, 2)	1.0
  (2, 2)	2.0
  (1, 2)	3.0
  (3, 3)	2.0
  (2, 3)	3.0
Full matrix A as an array
[[ 2.  3.  0.  0.]
 [ 1.  2.  3.  0.]
 [ 0.  1.  2.  3.]
 [ 0.  0.  1.  2.]]
</pre></div>
</div>
</div>
</div>
<p>There are many ways to store a sparse matrix. In the code above, the sparse matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> is stored in <em>compressed sparse column</em> (specified as <code class="docutils literal notranslate"><span class="pre">'csc'</span></code>). The advantages and disadvantages of this format are given <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csc_matrix.html">here</a>.  <code class="docutils literal notranslate"><span class="pre">A</span></code> is now a sparse matrix object. (Note that the multiplication sign does not do term-by-term multiplication for sparse matrix objects.) The solution to the system of equations <span class="math notranslate nohighlight">\(Ax=b\)</span> is obtained with the <code class="docutils literal notranslate"><span class="pre">spsolve</span></code> function of the <code class="docutils literal notranslate"><span class="pre">scipy.sparse.linalg</span></code> module.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.sparse.linalg</span> <span class="kn">import</span> <span class="n">spsolve</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;type of A:&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">spsolve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>  <span class="c1"># x is solution of Ax=b</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;right-hand-side defined as:&#39;</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;verify A @ x gives same:&#39;</span><span class="p">,</span> <span class="n">A</span> <span class="o">@</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>type of A: &lt;class &#39;scipy.sparse.csc.csc_matrix&#39;&gt;
right-hand-side defined as: [0 1 2 3]
verify A @ x gives same: [ 0.  1.  2.  3.]
</pre></div>
</div>
</div>
</div>
<p>The main advantage of sparse matrices is that you can solve <em>much</em> larger problems than with full matrices, as you only store the (few) points that are not zero. The solver <code class="docutils literal notranslate"><span class="pre">spsolve</span></code> also makes use of the sparsity of the matrix and will generally be faster.</p>
</section>
<section id="exercise-8-sparse-matrix">
<h3>Exercise 8 <a name="back8"></a> Sparse matrix<a class="headerlink" href="#exercise-8-sparse-matrix" title="Link to this heading">#</a></h3>
<p>Redo Exercise 5 but now use a <em>sparse</em> matrix. Obtain a solution for the head using <span class="math notranslate nohighlight">\(h_1^*=42\)</span>, <span class="math notranslate nohighlight">\(h_2^*=40\)</span>, and <span class="math notranslate nohighlight">\(N=10000\)</span>. All other parameters are the same as for Exercise 2. Create a plot of the head between the two canals. <strong>Warning</strong>: When you try to solve the problem with a regular (full) matrix and <span class="math notranslate nohighlight">\(N=10000\)</span>, you may run out of computer memory or the solve may take a <em>very</em> long time, and/or your program may hang. Don’t try this, but if you accidentally do this and your Notebook doesn’t recover, try to click on ‘Kernel’ in the menu bar at the top and then on ‘Restart’.</p>
<p><a href="#ex8answer">Answers to Exercise 8</a></p>
</section>
<section id="solutions-to-the-exercises">
<h3>Solutions to the exercises<a class="headerlink" href="#solutions-to-the-exercises" title="Link to this heading">#</a></h3>
<p><a name="ex1answer">Answers to Exercise 1</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
<span class="n">yp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">rhs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">tp</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">tp</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> \
           <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">tp</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">tp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>  <span class="c1"># Store one row at a time</span>
    <span class="n">rhs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">yp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a,b,c,d: &#39;</span><span class="p">,</span><span class="n">sol</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">sol</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">sol</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">sol</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;wave&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tp</span><span class="p">,</span> <span class="n">yp</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a,b,c,d:  [ 1.  2.  1. -1.]
</pre></div>
</div>
<img alt="../../../../_images/42086caf33b225e4c087be12d20d6853e8f7594ba71b4ef84ebffbe62254b78e.png" src="../../../../_images/42086caf33b225e4c087be12d20d6853e8f7594ba71b4ef84ebffbe62254b78e.png" />
</div>
</div>
<p><a href="#back1">Back to Exercise 1</a></p>
<p><a name="ex2answer">Answers to Exercise 2</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fpoly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">rv</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="o">**</span> <span class="n">n</span>
    <span class="k">return</span> <span class="n">rv</span>

<span class="nb">print</span><span class="p">(</span><span class="n">fpoly</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  1.   2.   4.   8.  16.]
</pre></div>
</div>
</div>
</div>
<p><a href="#back2">Back to Exercise 2</a></p>
<p><a name="ex3answer">Answers to Exercise 3</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">solvepoly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">mat</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpoly</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">N</span><span class="p">)</span>
    <span class="n">par</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">par</span>
    
<span class="n">xp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">yp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">solvepoly</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">yp</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 3.          2.33333333 -6.          1.66666667]
</pre></div>
</div>
</div>
</div>
<p><a href="#back3">Back to Exercise 3</a></p>
<p><a name="ex4answer">Answers to Exercise 4</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fpolyeval</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
        <span class="n">rv</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span> <span class="o">**</span> <span class="n">n</span>
    <span class="k">return</span> <span class="n">rv</span>

<span class="nb">print</span><span class="p">(</span><span class="n">fpolyeval</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 3.  1. -3.  1.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">fpolyeval</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">yp</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;fitted poly&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/79568b1744384eaa5e3d0a5253384bb3d904f73e04c7e25238092fcdf6a7a102.png" src="../../../../_images/79568b1744384eaa5e3d0a5253384bb3d904f73e04c7e25238092fcdf6a7a102.png" />
</div>
</div>
<p><a href="#back4">Back to Exercise 4</a></p>
<p><a name="ex5answer">Answers to Exercise 5</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">D</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">h1star</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">h2star</span> <span class="o">=</span> <span class="mi">22</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">P</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">40</span>

<span class="n">d0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># main diagonal</span>
<span class="n">d0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># first value of main diagonal is 1</span>
<span class="n">d0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># last value of main diagonal is 1</span>
<span class="n">dplus1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="c1"># diagonal right above main diagonal, position 1</span>
<span class="n">dplus1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c1"># first value of diagonal is 0</span>
<span class="n">dmin1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>  <span class="c1"># diagonal right below main diagonal, position -1</span>
<span class="n">dmin1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c1"># last value of diagonal is 0</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">d0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">dplus1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">dmin1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Right hand side</span>
<span class="n">delx</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="n">N</span>
<span class="n">rhs</span> <span class="o">=</span> <span class="o">-</span><span class="n">P</span> <span class="o">*</span> <span class="n">delx</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">D</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">rhs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">h1star</span>
<span class="n">rhs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">h2star</span>
<span class="c1"># Solve for the head and plot</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;head (m)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;maximum head &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>maximum head  22.45
</pre></div>
</div>
<img alt="../../../../_images/fb319523d205b40a29607b85031395140560d9276b8daadf387753120989210e.png" src="../../../../_images/fb319523d205b40a29607b85031395140560d9276b8daadf387753120989210e.png" />
</div>
</div>
<p><a href="#back5">Back to Exercise 5</a></p>
<p><a name="ex6answer">Answers to Exercise 6</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="mf">1e-6</span>  <span class="c1"># m^2/s</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># m</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">delt</span> <span class="o">=</span> <span class="mf">4e4</span>  <span class="c1"># seconds</span>
<span class="c1">#</span>
<span class="n">delz</span> <span class="o">=</span> <span class="n">h</span> <span class="o">/</span> <span class="n">N</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">delz</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">cv</span> <span class="o">*</span> <span class="n">delt</span><span class="p">)</span>

<span class="n">d0</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mu</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">d0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">dp1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">dp1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">dm1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">dm1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">d0</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">dp1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">dm1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">rhs</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu</span> <span class="o">*</span> <span class="n">p</span>
        <span class="n">rhs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">h</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">delz</span><span class="p">),</span> <span class="n">p</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; timesteps&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;maximum value after&#39;</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="p">(</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;timesteps is:&#39;</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Consolidation&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>maximum value after 10 timesteps is: 0.942582661527
maximum value after 20 timesteps is: 0.774232516343
maximum value after 30 timesteps is: 0.611765747348
maximum value after 40 timesteps is: 0.480122757381
maximum value after 50 timesteps is: 0.376368780322
</pre></div>
</div>
<img alt="../../../../_images/5545313a27ae918d88e5f53a5ef19dbee74fdb39e6b7effceb330e16b607ffbc.png" src="../../../../_images/5545313a27ae918d88e5f53a5ef19dbee74fdb39e6b7effceb330e16b607ffbc.png" />
</div>
</div>
<p><a href="#back6">Back to Exercise 6</a></p>
<p><a name="ex7answer">Answers to Exercise 7</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="mf">1e-6</span>  <span class="c1"># m^2/s</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># m</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">delt</span> <span class="o">=</span> <span class="mf">4e4</span>  <span class="c1"># seconds</span>
<span class="c1">#</span>
<span class="n">delz</span> <span class="o">=</span> <span class="n">h</span> <span class="o">/</span> <span class="n">N</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">delz</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">cv</span> <span class="o">*</span> <span class="n">delt</span><span class="p">)</span>

<span class="n">d0</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">mu</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">d0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">dp1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">dp1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">dm1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">dm1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">d0</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">dp1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">dm1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Ainv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">rhs</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu</span> <span class="o">*</span> <span class="n">p</span>
        <span class="n">rhs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">Ainv</span> <span class="o">@</span> <span class="n">rhs</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">h</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">delz</span><span class="p">),</span> <span class="n">p</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; timesteps&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;maximum value after&#39;</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="p">(</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;timesteps is:&#39;</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Consolidation&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>maximum value after 10 timesteps is: 0.942582661527
maximum value after 20 timesteps is: 0.774232516343
maximum value after 30 timesteps is: 0.611765747348
maximum value after 40 timesteps is: 0.480122757381
maximum value after 50 timesteps is: 0.376368780322
</pre></div>
</div>
<img alt="../../../../_images/5545313a27ae918d88e5f53a5ef19dbee74fdb39e6b7effceb330e16b607ffbc.png" src="../../../../_images/5545313a27ae918d88e5f53a5ef19dbee74fdb39e6b7effceb330e16b607ffbc.png" />
</div>
</div>
<p><a href="#back7">Back to Exercise 7</a></p>
<p><a name="ex8answer">Answers to Exercise 8</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">diags</span>
<span class="kn">from</span> <span class="nn">scipy.sparse.linalg</span> <span class="kn">import</span> <span class="n">spsolve</span> 
<span class="n">k</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">D</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">h1star</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">h2star</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">P</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">d0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># main diagonal</span>
<span class="n">d0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># first value of main diagonal is 1</span>
<span class="n">d0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># last value of main diagonal is 1</span>
<span class="n">dplus1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="c1"># diagonal right above main diagonal, position 1</span>
<span class="n">dplus1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c1"># first value of diagonal is 0</span>
<span class="n">dmin1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>  <span class="c1"># diagonal right below main diagonal, position -1</span>
<span class="n">dmin1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c1"># last value of diagonal is 0</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">diags</span><span class="p">([</span><span class="n">dmin1</span><span class="p">,</span> <span class="n">d0</span><span class="p">,</span> <span class="n">dplus1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;csc&#39;</span><span class="p">)</span>
<span class="c1"># Right hand side</span>
<span class="n">delx</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="n">N</span>
<span class="n">rhs</span> <span class="o">=</span> <span class="o">-</span><span class="n">P</span> <span class="o">*</span> <span class="n">delx</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">D</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">rhs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">h1star</span>
<span class="n">rhs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">h2star</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">spsolve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;node number&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;head (m)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/2d0701e4ef44438b49c64df3ab22c4e0b00fdcb580d9e45a414dd1a1e1255b49.png" src="../../../../_images/2d0701e4ef44438b49c64df3ab22c4e0b00fdcb580d9e45a414dd1a1e1255b49.png" />
</div>
</div>
<p><a href="#back8">Back to Exercise 8</a></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./ml-basic\references\exploratory_computing_with_python_translated\notebook6_linear_systems"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notebook-6-systems-of-linear-equations">Notebook 6: Systems of linear equations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-and-solving-a-system-of-linear-equations">Building and solving a system of linear equations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-fitting-a-wave">Exercise 1. <a name="back1"></a>Fitting a wave</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-an-arbitrary-polynomial">Fitting an arbitrary polynomial</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-the-fpoly-function">Exercise 2. <a name="back2"></a>The <code class="docutils literal notranslate"><span class="pre">fpoly</span></code> function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-the-solvepoly-function">Exercise 3. <a name="back3"></a>The <code class="docutils literal notranslate"><span class="pre">solvepoly</span></code> function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-the-fpolyeval-function">Exercise 4.  <a name="back3"></a>The <code class="docutils literal notranslate"><span class="pre">fpolyeval</span></code> function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-dimensional-groundwater-flow">One-dimensional groundwater flow</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5-the-head-between-two-canals">Exercise 5. <a name="back5"></a>The head between two canals</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#consolidation">Consolidation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6-one-dimensional-consolidation">Exercise 6. <a name="back6"></a>One-dimensional consolidation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-inverse-of-a-matrix">The inverse of a matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7-one-dimensional-consolidation-revisited">Exercise 7. <a name="back7"></a>One-dimensional consolidation revisited</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sparse-matrices">Sparse matrices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8-sparse-matrix">Exercise 8 <a name="back8"></a> Sparse matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solutions-to-the-exercises">Solutions to the exercises</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>